// Inicialização dos gráficos Chart.js
function initChartsChartJS() {
    // Configurações globais
    Chart.defaults.global.defaultFontColor = "#555555";
    Chart.defaults.scale.gridLines.color = "rgba(0,0,0,.04)";
    Chart.defaults.scale.gridLines.zeroLineColor = "rgba(0,0,0,.1)";
    Chart.defaults.scale.ticks.beginAtZero = true;

    Chart.defaults.global.elements.line.borderWidth = 2;
    Chart.defaults.global.elements.point.radius = 5;
    Chart.defaults.global.elements.point.hoverRadius = 7;

    Chart.defaults.global.tooltips.cornerRadius = 3;
    Chart.defaults.global.legend.labels.boxWidth = 12;

    // Seletores dos gráficos
    var chartLines = jQuery(".js-chartjs-lines");
    var chartBars = jQuery(".js-chartjs-bars");
    var chartRadar = jQuery(".js-chartjs-radar");
    var chartPolar = jQuery(".js-chartjs-polar");
    var chartPie = jQuery(".js-chartjs-pie");
    var chartDonut = jQuery(".js-chartjs-donut");

    // Dados para Line, Bar, Radar
    var dataLines = {
        labels: ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"],
        datasets: [
            {
                label: "This Week",
                fill: true,
                backgroundColor: "rgba(66,165,245,.75)",
                borderColor: "rgba(66,165,245,1)",
                pointBackgroundColor: "rgba(66,165,245,1)",
                pointBorderColor: "#fff",
                pointHoverBackgroundColor: "#fff",
                pointHoverBorderColor: "rgba(66,165,245,1)",
                data: [25, 38, 62, 45, 90, 115, 130]
            },
            {
                label: "Last Week",
                fill: true,
                backgroundColor: "rgba(66,165,245,.25)",
                borderColor: "rgba(66,165,245,1)",
                pointBackgroundColor: "rgba(66,165,245,1)",
                pointBorderColor: "#fff",
                pointHoverBackgroundColor: "#fff",
                pointHoverBorderColor: "rgba(66,165,245,1)",
                data: [112, 90, 142, 130, 170, 188, 196]
            }
        ]
    };

    // Dados para Pie / Donut / Polar
    var dataPie = {
        labels: ["Earnings", "Sales", "Tickets"],
        datasets: [
            {
                data: [50, 25, 25],
                backgroundColor: [
                    "rgba(156,204,101,1)",  // verde
                    "rgba(255,202,40,1)",   // amarelo
                    "rgba(239,83,80,1)"     // vermelho
                ],
                hoverBackgroundColor: [
                    "rgba(156,204,101,.5)",
                    "rgba(255,202,40,.5)",
                    "rgba(239,83,80,.5)"
                ]
            }
        ]
    };

    // Inicializando os gráficos se existirem no DOM
    if (chartLines.length) {
        new Chart(chartLines, { type: "line", data: dataLines });
    }
    if (chartBars.length) {
        new Chart(chartBars, { type: "bar", data: dataLines });
    }
    if (chartRadar.length) {
        new Chart(chartRadar, { type: "radar", data: dataLines });
    }
    if (chartPolar.length) {
        new Chart(chartPolar, { type: "polarArea", data: dataPie });
    }
    if (chartPie.length) {
        new Chart(chartPie, { type: "pie", data: dataPie });
    }
    if (chartDonut.length) {
        new Chart(chartDonut, { type: "doughnut", data: dataPie });
    }
}

// Executa quando o DOM estiver pronto
jQuery(function () {
    initChartsChartJS();
});


// Função que randomiza os valores dos gráficos Easy Pie Chart
function initRandomEasyPieChart() {
    jQuery(".js-pie-randomize").on("click", function (event) {
        jQuery(event.currentTarget)
            .parents(".block")
            .find(".pie-chart")
            .each(function (index, element) {
                // Atualiza o gráfico com um valor aleatório entre 1 e 100
                jQuery(element).data("easyPieChart").update(Math.floor(Math.random() * 100 + 1));
            });
    });
}

// Inicialização do Easy Pie Chart
jQuery(function () {
    // Cria os gráficos circulares
    jQuery(".pie-chart").easyPieChart({
        scaleColor: false,    // remove escala externa
        trackColor: "#eee",   // cor da trilha de fundo
        lineWidth: 5,         // espessura da linha
        size: 100,            // tamanho do gráfico
        animate: 1000,        // duração da animação (ms)
        barColor: "#42a5f5"   // cor da barra de progresso
    });

    // Ativa a função de randomizar
    initRandomEasyPieChart();
});
